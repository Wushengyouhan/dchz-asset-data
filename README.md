# 资产数据导出工具

支持从多个数据库系统导出资产层级数据到Excel文件。

## 安装依赖

```bash
npm install
```

## 使用方法

### 1. 蓝色系统导出

```bash
# 导出蓝色系统数据（使用hdbs_assets数据库）
npm run blue-system
```

**功能**：
- 查询一级资产及其子资产
- 生成包含父子关系的Excel文件
- 支持管理片区配置

### 2. 红色系统导出

```bash
# 导出红色系统数据（使用hdbs_dchz数据库）
npm run red-system
```

**功能**：
- 查询-99级顶级资产及其所有子资产（1级、2级、3级）
- 包含红色系统特有字段（NEW_AS_CODE、OLD_AS_CODE等）
- 递归查询所有层级关系

## 配置管理片区

编辑 `config.js` 文件中的管理片区配置：

```javascript
managementArea: {
  name: '十堰东资产经营中心'  // 修改为其他管理片区名称
}
```

## 输出文件

- **位置**：`./output/` 目录
- **格式**：`.xlsx`
- **命名规则**：
  - 蓝色系统：`蓝色系统_{管理片区名称}_资产数据_{时间戳}.xlsx`
  - 红色系统：`红色系统_{管理片区名称}_资产数据_{时间戳}.xlsx`

## 数据库配置

支持两个数据库系统：

1. **蓝色系统**：`hdbs_assets` 数据库
2. **红色系统**：`hdbs_dchz` 数据库

数据库连接信息在 `config.js` 中配置，包含完整的连接参数和安全设置。
